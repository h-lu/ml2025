## 机器学习 - 16 周授课计划 (经管学院大三)

**核心理念:** 实战导向，弱化数学，强化应用，深度融合 AI 辅助编程，聚焦经典机器学习及其在商业中的深化应用。

**每周安排:** 2 次课，每次 90 分钟。

---

### **第一阶段 (1-2周): 机器学习与Python入门**

**(基本保持不变，细节微调，强化 AI 工具引导)**

#### **第 1 周: 导论与环境**

*   **第一次课 (1/32): 机器学习导论与商业应用**
    *   **教学内容:** 课程介绍，ML 核心概念，ML vs. 统计/数据挖掘，商业应用案例深度剖析 (精准营销、风控、运营优化等)，Python ML 生态介绍。
    *   **课堂活动:** 分组讨论 AI/ML 应用，**重点演示** AI 辅助编程工具 (Copilot/灵码/Cursor) 的安装、基础代码补全、注释生成、简单代码生成功能。
*   **第二次课 (2/32): Python 环境搭建与基础**
    *   **教学内容:** Anaconda/Python+pip 安装，VS Code/Cursor 配置 (插件)，**AI 辅助实践:** 使用 AI 工具辅助完成 Python 基础语法练习 (变量、类型、运算符、控制流、函数)，Jupyter Notebook in VS Code 操作。
    *   **实践与作业:** 完成环境搭建，使用 AI 工具完成 Python 基础练习，熟悉 VS Code + Jupyter。

#### **第 2 周: 数据处理基础与项目启动**

*   **第一次课 (3/32): Numpy & Pandas 核心操作**
    *   **教学内容:** `Numpy` 核心 (数组、运算、常用函数、索引)，`Pandas` 核心 (Series/DataFrame、读写、查看探索、选择索引)，**AI 辅助实践:** 使用 AI 工具生成 Pandas 数据读取、选择、探索代码。
    *   **实践:** Numpy 和 Pandas 基础操作练习。
*   **第二次课 (4/32): 数据预处理与特征工程入门 + 项目一启动**
    *   **教学内容:** 数据清洗 (缺失值、重复值)，特征工程基础 (数值缩放 - StandardScaler/MinMaxScaler，类别编码 - OneHot/Label Encoding)，`scikit-learn` 预处理模块介绍。**AI 辅助实践:** 使用 AI 工具辅助编写数据清洗和特征转换代码 (例如: "帮我用 scikit-learn 对'类别'列进行独热编码")。
    *   **小组项目一启动:**
        *   **主题:** 电商用户行为数据探索与预处理。(同前)
        *   **任务:** 分组，选数据集，进行 EDA 和预处理。
        *   **提交:** 预处理后的数据集 (`.csv`) + Jupyter Notebook (`.ipynb`)。
        *   **DDL:** 第 3 周第一次课前。
    *   **课堂活动:** 分组，讨论数据集，教师演示 AI 辅助数据探索。

---

### **第二阶段 (3-8周): 机器学习核心算法实践**

**(基本保持不变，强化评估指标解读和 AI 应用)**

#### **第 3 周: 分类算法 (一) - 逻辑回归 & SVM**

*   **第一次课 (5/32): 逻辑回归**
    *   **教学内容:** 项目一检查点，分类问题概述，逻辑回归原理 (直观)，`scikit-learn` 实现，模型评估指标 (Accuracy, Confusion Matrix, Precision, Recall, F1-Score - **结合商业场景深度解读**)，**AI 辅助实践:** 使用 AI 工具解释混淆矩阵，生成模型训练和评估代码。
    *   **实践:** 简单数据集上训练评估 LR。
*   **第二次课 (6/32): 支持向量机 (SVM) + 项目一模型构建**
    *   **教学内容:** SVM 原理 (最大间隔、核函数 - 直观)，`scikit-learn` 实现 (SVC, C/gamma 影响)，优缺点，ROC 曲线与 AUC 值 (含义与解读)，训练/测试集划分 (`train_test_split`)。
    *   **小组项目一指导:**
        *   **任务:** 使用 LR 或 SVM 构建分类模型。
        *   **提交:** 更新后的 Notebook (含模型训练、评估、结果分析)。
        *   **DDL:** 第 4 周第一次课前。
    *   **课堂活动:** 分组进行项目一模型训练评估，教师巡回指导。

#### **第 4 周: 分类算法 (二) - 决策树 & 随机森林**

*   **第一次课 (7/32): 决策树**
    *   **教学内容:** 优秀项目展示 (可选)，决策树原理 (递归分裂，熵/基尼 - 直观)，`scikit-learn` 实现 (DecisionTreeClassifier, 重要参数)，可视化 (`plot_tree`)，优缺点。
    *   **实践:** 训练决策树，调参观察影响。
*   **第二次课 (8/32): 集成学习 - 随机森林 + 项目一模型优化**
    *   **教学内容:** 集成学习思想 (Bagging)，随机森林原理，`scikit-learn` 实现 (RandomForestClassifier)，优点，特征重要性 (`feature_importances_`)，交叉验证 (CV) 概念与实践，网格搜索 (GridSearchCV) 自动化调参。**AI 辅助实践:** 使用 AI 工具解释 GridSearchCV 参数，生成调优代码框架。
    *   **小组项目一指导:**
        *   **任务:** 使用 RF 优化模型，进行 GridSearchCV 调优，对比性能，完成报告。
        *   **提交:** 最终 Notebook + 项目报告 (.md/.pdf)。
        *   **DDL:** 第 5 周第一次课前。
    *   **课堂活动:** 分组进行 RF 训练、调优、报告撰写，教师指导。

#### **第 5 周: 回归算法 (一) - 线性回归 & 多项式回归**

*   **第一次课 (9/32): 线性回归**
    *   **教学内容:** 项目一提交提醒，回归问题概述与应用，线性回归原理 (最小二乘 - 直观)，`scikit-learn` 实现 (LinearRegression)，回归评估指标 (MSE, RMSE, MAE, R-squared - **含义与解读**)。**AI 辅助实践:** 使用 AI 工具解释 R-squared，生成线性回归代码。
    *   **实践:** 简单数据集上训练评估线性回归。
    *   **小组项目二启动:**
        *   **主题:** 房价预测模型构建。(同前)
        *   **任务 (阶段一):** 数据预处理，使用 **线性回归** 构建基础模型。
        *   **提交:** 包含预处理、线性回归模型训练评估的 Notebook。
        *   **DDL:** 第 6 周第一次课前。
*   **第二次课 (10/32): 多项式回归 & 正则化**
    *   **教学内容:** 线性回归局限，多项式回归原理与实现 (结合 `PolynomialFeatures`)，过拟合引入，正则化概念 (L1/Lasso, L2/Ridge - 直观理解与 `scikit-learn` 实现)。
    *   **小组项目二指导:**
        *   **任务:** 尝试多项式回归或带正则化的线性回归改进模型，对比效果。
    *   **课堂活动:** 分组进行项目二预处理和基础模型构建。

#### **第 6 周: 回归算法 (二) - 集成学习 (XGBoost)**

*   **第一次课 (11/32): Boosting 与 XGBoost**
    *   **教学内容:** 优秀项目展示 (可选)，Boosting 思想，GBDT 原理简介，XGBoost 优势与实现 (`xgboost` 库, `XGBRegressor`)，常用参数介绍 (直观理解)。**AI 辅助实践:** 使用 AI 工具查找 XGBoost 参数文档，解释参数含义。
    *   **实践:** 示例数据集上训练 XGBoost 回归，对比线性回归。
*   **第二次课 (12/32): XGBoost 调优 + 项目二模型优化**
    *   **教学内容:** XGBoost 参数调优策略，使用 `GridSearchCV`/`RandomizedSearchCV` 调优实践，回归模型选择与评估总结。
    *   **小组项目二指导:**
        *   **任务:** 使用 XGBoost 优化模型，进行调优，对比性能，完成报告。
        *   **提交:** 最终 Notebook + 项目报告 (.md/.pdf)。
        *   **DDL:** 第 7 周第一次课前。
    *   **课堂活动:** 分组进行 XGBoost 训练、调优、报告撰写。

#### **第 7 周: 聚类算法 (一) - K-Means**

*   **第一次课 (13/32): K-Means 聚类**
    *   **教学内容:** 项目二提交提醒，无监督学习与聚类概述，K-Means 原理与步骤，`scikit-learn` 实现 (KMeans)，K 值选择 (肘部法则, 轮廓系数 - 原理与实践)，优缺点。
    *   **实践:** 简单数据集上运行 K-Means，可视化，尝试不同 K 值。
    *   **小组项目三启动:**
        *   **主题:** 用户分群模型构建。(同前)
        *   **任务 (阶段一):** 数据预处理 (特征缩放!)，使用 K-Means 进行聚类，确定 K 值。
        *   **提交:** 包含预处理、K-Means 聚类过程 (含 K 值选择)、初步可视化的 Notebook。
        *   **DDL:** 第 8 周第一次课前。
*   **第二次课 (14/32): 聚类评估与可视化**
    *   **教学内容:** 聚类评估指标深入 (轮廓系数, Davies-Bouldin 指数)，聚类结果可视化 (二维散点图，高维数据降维 PCA/t-SNE 后可视化 - **实践**)。**AI 辅助实践:** 使用 AI 工具生成聚类结果可视化代码 (如 "用 seaborn 画出 K-Means 结果散点图，按簇标签着色并显示聚类中心")。
    *   **小组项目三指导:**
        *   **任务:** 评估 K-Means 结果，进行可视化，初步解释簇特征。
    *   **课堂活动:** 分组进行项目三 K-Means 实践、评估和可视化。

#### **第 8 周: 聚类算法 (二) - DBSCAN 与项目三优化**

*   **第一次课 (15/32): DBSCAN 聚类**
    *   **教学内容:** 优秀项目展示 (可选)，K-Means 局限，DBSCAN 原理 (核心点、边界点、噪声点，密度连接)，`scikit-learn` 实现 (DBSCAN, `eps`/`min_samples` 参数选择)，优缺点。
    *   **实践:** 在适合 DBSCAN 的数据集上对比 K-Means 和 DBSCAN。
*   **第二次课 (16/32): 聚类算法选择与 **业务解读强化** + 项目三优化**
    *   **教学内容:** 聚类算法选择对比 (K-Means vs. DBSCAN)，**重点：聚类结果的业务解读** - 如何分析各簇特征 (`groupby().mean()`, 可视化特征分布)，如何给簇贴标签，如何转化为商业洞察。
    *   **小组项目三指导:**
        *   **任务:** 尝试 DBSCAN 或优化 K-Means，对比效果，**深入进行业务解读**，完成报告。
        *   **要求:** 报告中必须包含详细的业务解读部分。
        *   **提交:** 最终 Notebook + 项目报告 (.md/.pdf)。
        *   **DDL:** 第 9 周第一次课前。
    *   **课堂活动:** 分组进行模型优化、**重点进行结果分析与业务解读**、报告撰写。

---

### **第三阶段 (9-13周): 机器学习深化与专题应用 (新内容)**

**目标:** 掌握更高级的模型评估与选择技巧，学习处理不平衡数据，深入时间序列分析，并初步接触模型可解释性。

#### **第 9 周: 模型评估深化与不平衡数据处理**

*   **第一次课 (17/32): 高级模型评估与选择**
    *   **教学内容:** 项目三提交提醒，评估指标深化 (精确率-召回率 P-R 曲线 - 特别适用于不平衡数据)，交叉验证策略深化 (Stratified K-Fold, Nested CV 概念)，多分类评估 (Macro/Micro/Weighted Avg)。
    *   **实践:** 绘制 P-R 曲线，对比不同 CV 策略。**AI 辅助:** 解释 P-R 曲线与 ROC 曲线的适用场景差异。
*   **第二次课 (18/32): 处理不平衡数据**
    *   **教学内容:** 不平衡数据挑战与场景，处理策略：数据层面 (欠采样概念, 过采样 - **SMOTE** 原理与实践 - `imbalanced-learn` 库)，算法层面 (代价敏感学习 `class_weight='balanced'`)。
    *   **实践:** 使用 `imbalanced-learn` 应用 SMOTE，对比处理前后模型性能 (用 P-R 曲线评估)。
    *   **课堂活动/案例:** 分析不平衡商业数据集，讨论策略。

#### **第 10 周: 降维与特征选择**

*   **第一次课 (19/32): 主成分分析 (PCA) 深入**
    *   **教学内容:** 降维必要性，PCA 原理回顾与深入 (寻找最大方差，方差解释率)，`scikit-learn` PCA 实现细节 (`n_components` 选择, `explained_variance_ratio_`)，应用 (压缩、去噪、可视化)，局限性。
    *   **实践:** 对多维数据集应用 PCA，分析方差解释率，选择 компонент，可视化降维结果。
*   **第二次课 (20/32): 特征选择技术**
    *   **教学内容:** 特征选择 vs. 特征提取，方法分类：过滤法 (方差阈值, 相关系数, 单变量选择 - `SelectKBest`)，包裹法 (RFE - 递归特征消除)，嵌入法 (Lasso 回顾, 树模型特征重要性回顾)。`sklearn.feature_selection` 实践。
    *   **实践/讨论:** 对比不同方法，讨论应用场景。**AI 辅助:** 生成 RFE 使用代码，比较 Filter/Wrapper/Embedded 方法优劣。

#### **第 11 周: 时间序列分析基础**

*   **第一次课 (21/32): 时间序列数据特性与处理**
    *   **教学内容:** 时间序列在商业中的重要性，特性 (时间依赖、趋势、季节性、周期、噪声)，`pandas` 处理时间序列 (`datetime` 索引, `resample`, `rolling`, `shift`)。
    *   **实践:** 加载时间序列数据，进行时间索引转换、重采样、计算移动平均并可视化。
    *   **小组项目四启动:**
        *   **主题:** **商业时间序列预测** (例如：商品销售额、网站流量预测)。
        *   **目标:** 掌握时间序列分析的基本流程和预测方法。
        *   **任务 (阶段一):** 选择数据集，进行时间序列探索性分析 (EDA)，包括数据加载、可视化、识别趋势/季节性等。
        *   **提交:** 包含时间序列 EDA 的 Notebook。
        *   **DDL:** 第 12 周第一次课前。
*   **第二次课 (22/32): 时间序列分解与平稳性**
    *   **教学内容:** 时间序列分解 (`seasonal_decompose`)，平稳性概念与重要性，检验方法 (可视化, ADF 检验 - `adfuller`)，使序列平稳的方法 (差分 `diff()`, 对数变换)。
    *   **实践:** 对时间序列数据进行分解，ADF 检验，尝试差分使之平稳。**AI 辅助:** 解释 ADF 检验结果，生成差分代码。
    *   **小组项目四指导:** 继续进行数据处理，特别是平稳性检验和处理。

#### **第 12 周: 时间序列预测模型 (统计)**

*   **第一次课 (23/32): 基准模型与 ARIMA 概念**
    *   **教学内容:** 时间序列预测概述，基准模型 (Mean, Naive, Seasonal Naive)，ARIMA 模型概念 (AR, MA, I, 阶数 p,d,q)。
    *   **实践:** 计算基准模型的预测结果并评估 (MAE, RMSE, MAPE)。
    *   **小组项目四指导:** 完成数据平稳化处理，构建并评估基准模型。
*   **第二次课 (24/32): ARIMA 模型实践**
    *   **教学内容:** ACF/PACF 图辅助定阶 (直观解读)，使用 `statsmodels.tsa.arima.model.ARIMA` 拟合模型，模型诊断 (残差白噪声)，预测 (`predict`/`forecast`)。(可选) 自动定阶 `pmdarima.auto_arima`。
    *   **实践:** 选择阶数，拟合 ARIMA，预测，评估，与基准对比。**AI 辅助:** 查找 `statsmodels` ARIMA 文档，解释模型摘要。
    *   **小组项目四指导:** 构建、评估 ARIMA 模型，对比基准模型。

#### **第 13 周: 模型可解释性 (XAI) 初探**

*   **第一次课 (25/32): 可解释性的重要性与全局解释**
    *   **教学内容:** 为何需要解释 (信任、调试、偏见、合规、洞察)，方法分类 (内在 vs. 模型无关)，全局解释：特征重要性 (Permutation Importance)，部分依赖图 (PDP)。
    *   **实践:** 对先前项目复杂模型 (如 XGBoost) 计算 Permutation Importance，绘制 PDP 图并解释。
*   **第二次课 (26/32): 局部解释 (LIME & SHAP)**
    *   **教学内容:** 局部解释目的，LIME 原理与 `lime` 库实践，SHAP 原理 (Shapley 值) 与 `shap` 库实践 (`TreeExplainer`, `KernelExplainer`, 可视化 `force_plot`, `summary_plot`)。
    *   **实践:** 使用 `shap` 解释树模型（来自项目二或三）的单个预测和全局特征贡献。**AI 辅助:** 解释 SHAP 图的含义。
    *   **小组项目四指导:**
        *   **任务:** 完成 ARIMA 模型预测，撰写报告，包含数据处理、模型选择、结果评估、**业务预测解读**。 (可选：对项目中使用的某个模型进行简单的 XAI 分析)。
        *   **提交:** 最终 Notebook + 项目报告 (.md/.pdf)。
        *   **DDL:** 第 14 周第一次课前。

---

### **第四阶段 (14-16周): 小组综合项目实战与商业应用拓展**

**(内容调整，聚焦经典 ML 融合)**

#### **第 14-15 周 (共4次课): 小组综合项目开发与指导**

*   **内容:** 学生以小组为单位，进行**小组综合项目**的设计、开发和实验。
    *   **选题方向调整:** 鼓励选择能**融合本学期所学多种经典 ML 技术**的开放式商业问题。例如：
        *   结合用户分群 (聚类) 与流失预测 (分类+不平衡处理)。
        *   结合销量预测 (时间序列) 与影响因素分析 (回归+XAI)。
        *   市场细分 (聚类) + 各细分市场价值预测 (回归)。
        *   复杂数据集的降维/特征选择 + 高性能模型构建与解释。
*   **指导:** 教师课堂指导，**强调技术整合与业务价值**，解答问题。鼓励 AI 工具深度应用。
*   **检查:** 第 15 周进行中期检查，评估方案可行性、技术融合度、预期业务价值。

#### **第 16 周 (共2次课): 小组综合项目展示与课程总结**

*   **第一次课 (27/32): 小组综合项目展示与答辩**
    *   **展示:** 各小组展示成果，讲解背景、问题、技术方案（**如何融合多种技术**）、结果、商业价值、遇到的挑战及解决方法。
    *   **答辩:** 师生提问点评。
    *   **小组综合项目报告和材料提交 (本周课前)。**
*   **第二次课 (28/32): 课程总结与未来展望**
    *   **总结:** 回顾课程核心内容 (数据处理、监督学习、无监督学习、时间序列、XAI 等)，强调 ML 在商业决策中的作用。
    *   **展望:** ML 发展趋势，持续学习建议，**再次强调数据伦理、模型偏见与公平性、可解释性的重要性**。
    *   **评估:** 课程评估与反馈。

---

**项目设置 (修订):**

*   **项目一 (Week 2-4):** 电商用户行为 EDA 与分类 (LR/SVM/RF) - **DDL Week 5**
*   **项目二 (Week 5-6):** 房价预测 (Linear/Poly/Ridge/Lasso/XGBoost) - **DDL Week 7**
*   **项目三 (Week 7-8):** 用户分群 (K-Means/DBSCAN) 与**业务解读** - **DDL Week 9**
*   **项目四 (Week 11-13):** **商业时间序列预测 (ARIMA)** - **DDL Week 14**
*   **小组综合项目 (Week 14-16):** 开放式商业问题 (融合多种经典 ML 技术) - **DDL Week 16**
